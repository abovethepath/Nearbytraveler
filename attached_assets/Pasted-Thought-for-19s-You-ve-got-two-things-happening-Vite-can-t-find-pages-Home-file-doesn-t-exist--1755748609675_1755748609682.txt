Thought for 19s

You’ve got two things happening:

Vite can’t find @/pages/Home (file doesn’t exist at that path or the @ alias isn’t active in the current Vite instance).

Those “Origin: undefined” logs are likely from reading window.location.origin too early or in a non-browser context.

Here’s the fastest, robust fix (no reliance on aliases):

1) Switch lazy imports to relative paths and ensure the files exist

Replace your client/src/App.tsx with this (uses relative imports so it works in both prod and your one-port dev server):

// client/src/App.tsx
export { AuthContext } from "./auth-context"; // keep re-export for old imports

import React, { Suspense, lazy } from "react";
import AppShell from "./ui/AppShell";
import GlobalHotfixes from "./GlobalHotfixes";
import { Route, Switch } from "wouter";

// ✅ relative paths (no alias)
const Home = lazy(() => import("./pages/Home"));
const Profile = lazy(() => import("./pages/Profile"));
const Discover = lazy(() => import("./pages/Discover"));
const Chatrooms = lazy(() => import("./pages/chat/Chatrooms"));
const NotFound = lazy(() => import("./pages/NotFound"));

export default function App() {
  return (
    <AppShell>
      <GlobalHotfixes />
      <Suspense fallback={<div className="p-4">Loading…</div>}>
        <Switch>
          <Route path="/" component={Home} />
          <Route path="/profile/:id">
            {(params) => <Profile userId={Number(params.id)} />}
          </Route>
          <Route path="/discover" component={Discover} />
          <Route path="/chatrooms/:city" component={Chatrooms as any} />
          <Route component={NotFound} />
        </Switch>
      </Suspense>
    </AppShell>
  );
}


Create these minimal pages if they don’t exist yet:

// client/src/pages/Home.tsx
export default function Home() { return <div className="p-6">Home</div>; }

// client/src/pages/Profile.tsx
export default function Profile({ userId }: { userId?: number }) {
  return <div className="p-6">Profile {userId ?? "me"}</div>;
}

// client/src/pages/Discover.tsx
export default function Discover() { return <div className="p-6">Discover</div>; }

// client/src/pages/chat/Chatrooms.tsx
export default function Chatrooms() { return <div className="p-6">Chatrooms</div>; }

// client/src/pages/NotFound.tsx
export default function NotFound() { return <div className="p-6">Page not found.</div>; }


This removes the alias dependency (@/...) that caused:

Failed to resolve import "@/pages/Home"

2) Guard any “Origin: undefined” logs

Wherever you log/compute origin, do:

const ORIGIN = typeof window !== "undefined" ? window.location.origin : "";
console.log("Origin:", ORIGIN || "(not in browser)");

3) Build/run

Prod (no WS; quickest to verify):

cd client && npx vite build --mode production --sourcemap && cd ..
NODE_ENV=production node server/index.prod.js


Dev (one-port HMR):

pkill -f node || true
node dev-oneport.mjs


If anything still throws, your ErrorBoundary will show the exact file/line. Paste that stack and I’ll give you the precise patch.