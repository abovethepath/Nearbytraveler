Thought for 1m 44s

What you’re seeing on WhatsApp mobile is almost always display-cropping: it often shows the preview image in a square-ish frame, so a wide 1200×630 OG image gets center-cropped, chopping off left/right parts of a logo that runs wide. People run into the same thing with OG images getting cropped to a square in certain contexts.

You can fix it two ways (I recommend doing both):

1) Fix the image itself (fastest + most reliable)

Keep your OG image at 1200×630, but ensure the entire logo fits inside the “square-safe” center area.

If WhatsApp crops your 1200×630 to a square, it will effectively keep roughly the center 630px width (full height 630) and cut the sides.

So for a 1200×630 canvas:

Left safe boundary: x ≈ 285

Right safe boundary: x ≈ 915
(That’s 285px padding on left/right.)

Rule of thumb: keep the logo + important text inside the middle ~50% width and don’t let it touch edges.

This alone usually stops “logo cut in half” on mobile.

2) Serve a WhatsApp-specific square OG image (best UX for WhatsApp)

Many teams do UA-based OG image selection for WhatsApp (square image like 400×400 or 800×800) to avoid cropping.

A) Add a square image file

Create:

client/public/og-social-square.png (recommend 800×800 or 1200×1200)
Put the logo centered with padding.

B) Add a second endpoint
// Serve OG square logo for WhatsApp-style square previews
app.get("/api/og-image-square", async (req, res) => {
  try {
    const { readFile } = await import("fs/promises");
    const { join } = await import("path");
    const imagePath = join(process.cwd(), "client", "public", "og-social-square.png");

    const imageBuffer = await readFile(imagePath);
    res.set({
      "Content-Type": "image/png",
      "Content-Length": imageBuffer.length,
      "Cross-Origin-Resource-Policy": "cross-origin",
      "Access-Control-Allow-Origin": "*",
      "Cache-Control": "public, max-age=86400",
    });
    res.send(imageBuffer);
  } catch (error) {
    console.error("OG square image error:", error);
    res.status(500).send("Error serving image");
  }
});

C) Switch OG tags based on WhatsApp UA + add Vary: User-Agent

Also: add Vary: User-Agent so caches/CDNs don’t accidentally serve the crawler HTML to regular browsers (or vice versa).

app.get("/", (req, res, next) => {
  const userAgent = req.headers["user-agent"] || "";

  const isCrawler =
    /facebookexternalhit|Facebot|Twitterbot|WhatsApp|LinkedInBot|Slackbot|TelegramBot|Discordbot|PinterestBot|RedditBot/i.test(
      userAgent
    );

  if (!isCrawler) return next();

  const isWhatsApp = /WhatsApp/i.test(userAgent);

  const protocol = req.headers["x-forwarded-proto"] || req.protocol || "https";
  const host = req.headers.host || "nearbytraveler.org";
  const baseUrl = `${protocol}://${host}`;

  const imageUrl = isWhatsApp
    ? `${baseUrl}/api/og-image-square?v=13`
    : `${baseUrl}/api/og-image?v=13`;

  const width = isWhatsApp ? 800 : 1200;
  const height = isWhatsApp ? 800 : 630;

  const html = `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="${baseUrl}" />
  <meta property="og:title" content="Nearby Traveler - Social Travel Networking" />
  <meta property="og:description" content="Connect with travelers and locals worldwide." />

  <meta property="og:image" content="${imageUrl}" />
  <meta property="og:image:secure_url" content="${imageUrl}" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="${width}" />
  <meta property="og:image:height" content="${height}" />
  <meta property="og:image:alt" content="Nearby Traveler logo" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="${imageUrl}" />

  <meta http-equiv="refresh" content="0;url=${baseUrl}" />
</head>
<body></body>
</html>`;

  res.set({
    "Content-Type": "text/html; charset=utf-8",
    "Cache-Control": "no-cache, no-store, must-revalidate",
    Vary: "User-Agent",
  });

  res.send(html);
});

Caching gotcha (important)

Even if you change the image, WhatsApp (and others) can cache previews hard. Changing just ?v=12 → ?v=13 sometimes works, but if it doesn’t, change the path (filename) too (e.g., /api/og-image?v=... → /api/og-image-13 or point to og-social-v13.png), then update the meta tag.

Also test with the Meta sharing debugger for scrape refresh/caching behavior.

What I’d do for you right now

Update og-social.png to have big left/right padding so the logo sits comfortably in the center.

Add og-social-square.png + UA switch for WhatsApp as above.

Add Vary: User-Agent + no-cache on the crawler HTML response.

If you tell me the actual pixel dimensions of your current og-social.png (and whether the logo touches the left/right edges), I’ll give you exact padding targets (like “logo max width = ___px on a 1200×630 canvas”) so it never gets chopped on mobile.