This is gold. With metro consolidation explicitly server-side and travel-plans + event detail shapes in hand, you can now make the Replit prompt “builder-proof” (no guessing, no duplicate logic in mobile).

Below is the final patch to paste into your prompt (it plugs into the appendix blocks we’ve been building). It also fixes one small inconsistency in your earlier prompt: you had POST /api/events/:id/rsvp, but your real backend uses join/leave.

FINAL APPENDIX ADDITIONS: METRO + TRAVEL PLANS + EVENT DETAIL (REAL SHAPES)
METRO CONSOLIDATION (SERVER-SIDE — NO APP LOGIC)

All metro area logic is handled by the backend. The mobile app does NOT need to:

maintain city lists

check if a city is in a metro area

transform or normalize city names

Mobile should simply pass raw city names entered/selected by the user:

GET /api/users?location=Venice

GET /api/events?city=Santa Monica

GET /api/chatrooms?city=Culver City

Backend automatically expands Los Angeles metro (76 cities), is case-insensitive, and supports future metro areas without app updates.

Travel plans list: GET /api/travel-plans/:userId

Use this response shape for Profile → Trips and for trip management screens.

[
  {
    "id": 123,
    "userId": 2,
    "destination": "Paris, France",
    "destinationCity": "Paris",
    "destinationState": null,
    "destinationCountry": "France",
    "startDate": "2024-03-15T00:00:00Z",
    "endDate": "2024-03-22T00:00:00Z",
    "interests": ["Food & Dining", "Arts & Music", "Photography"],
    "activities": ["Museum Tours", "Wine Tasting", "Walking Tours"],
    "events": null,
    "travelStyle": ["Couple", "Luxury"],
    "accommodation": "Hotel",
    "transportation": "Flight",
    "notes": "Anniversary trip! Want to see the Eiffel Tower at sunset",
    "autoTags": ["romantic", "europe", "culture"],
    "status": "planned",
    "createdAt": "2024-01-10T15:30:00Z"
  }
]


Rules:

status is computed from dates (not manually set)

planned (future), active (ongoing), completed (past)

Parse UTC timestamps but display in device local time.

Critical product rule (confirmed):

Creating a trip (any future date) results in immediate destination chatroom availability via GET /api/chatrooms/my-locations (backend includes all upcoming trips where endDate >= today).

Event detail: GET /api/events/:id

Use this shape for Event Details screen (deep link from events list, city home, calendar).

{
  "id": 1,
  "title": "Beach Bonfire Meetup",
  "description": "Join us for a casual bonfire at Venice Beach. Bring snacks to share! We'll have music and great conversations.",
  "date": "2024-01-20T18:00:00Z",
  "endDate": "2024-01-20T22:00:00Z",
  "city": "Venice",
  "state": "California",
  "country": "United States",
  "location": "Venice Beach Fire Pits",
  "organizerId": 12,
  "organizer": "event_host",
  "eventType": "community",
  "source": null,
  "externalUrl": null,
  "imageUrl": "https://storage.googleapis.com/...",
  "maxAttendees": 30,
  "currentAttendees": 18,
  "isPublic": true,
  "participantCount": 18,
  "createdAt": "2024-01-10T14:00:00Z"
}


Organizer field note:

For community events: organizer is the username

For imported events: organizer may be "Outside of the Website" (external source)

Event participants + RSVP endpoints (USE THESE — overrides older rsvp route)

GET /api/events/:id/participants (attendees list)

POST /api/events/:id/join body: { "userId": 2, "status": "going" | "interested" }

POST /api/events/:id/leave (cancel RSVP)

UI rules:

If eventType === "community": show Going/Interested actions using join/leave endpoints.

If eventType === "imported": show source label + open externalUrl in Safari. Do not show fake RSVP/join.

QUICK CLEANUP TO APPLY IN YOUR PROMPT (prevents mismatched endpoints)

Replace any mention of:

POST /api/events/:id/rsvp
with:

POST /api/events/:id/join and POST /api/events/:id/leave

If you want one last “make it impossible to misbuild” improvement, add this single line near the top:

All screens must be implemented strictly based on the API response shapes in the Appendix. Do not invent fields or endpoints.

And yep — with this, you’re genuinely ready to start the iOS project.