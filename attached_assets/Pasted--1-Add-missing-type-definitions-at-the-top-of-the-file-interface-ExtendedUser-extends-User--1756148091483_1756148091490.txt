// 1. Add missing type definitions at the top of the file
interface ExtendedUser extends User {
  isVeteran?: boolean;
  isActiveDuty?: boolean;
  isMinorityOwned?: boolean;
  isFemaleOwned?: boolean;
  isLGBTQIAOwned?: boolean;
  showMinorityOwned?: boolean;
  showFemaleOwned?: boolean;
  showLGBTQIAOwned?: boolean;
  childrenAges?: string;
  ownerName?: string;
  contactName?: string;
  ownerEmail?: string;
  ownerPhone?: string;
  services?: string;
  specialOffers?: string;
  targetCustomers?: string;
  certifications?: string;
  customInterests?: string;
  customActivities?: string;
  customEvents?: string;
}

// 2. Add missing constants (add these imports at the top)
const INTERESTS_OPTIONS = getAllInterests();
const ACTIVITIES_OPTIONS = getAllActivities();
const EVENTS_OPTIONS = getAllEvents();

// 3. Fix type conversion issues - replace lines 823 and 843:
// OLD: setLocation(`/profile/${connection.connectedUser?.id}`)
// NEW:
setLocation(`/profile/${connection.connectedUser?.id?.toString() || ''}`)

// OLD: setLocation(`/profile/${request.requesterUser?.id}`)
// NEW:
setLocation(`/profile/${request.requesterUser?.id?.toString() || ''}`)

// 4. Fix date handling issue - replace line 1423:
// OLD: dateOfBirth: user.dateOfBirth ? new Date(user.dateOfBirth).toISOString().split('T')[0] : "",
// NEW:
dateOfBirth: user.dateOfBirth ? 
  (typeof user.dateOfBirth === 'string' ? user.dateOfBirth : new Date(user.dateOfBirth).toISOString().split('T')[0]) : "",

// 5. Fix fetch headers typing - replace the fetch call around line 2903:
const response = await fetch(`/api/users/${effectiveUserId}`, {
  method: 'PUT',
  headers: {
    'Content-Type': 'application/json',
    'x-user-id': effectiveUserId?.toString() || '',
    'x-user-type': user?.userType || 'business'
  } as Record<string, string>,
  body: JSON.stringify(payload)
});

// 6. Fix user type casting throughout the file - replace user with (user as ExtendedUser):

// Example replacements:
// OLD: user.isVeteran
// NEW: (user as ExtendedUser).isVeteran

// OLD: user.childrenAges
// NEW: (user as ExtendedUser).childrenAges

// OLD: user.ownerName
// NEW: (user as ExtendedUser).ownerName

// 7. Fix the specific property access issues:

// Line 1215 - ownerName property:
ownerName: (user as ExtendedUser).ownerName || "",

// Line 1339 - childrenAges property:
childrenAges: (user as ExtendedUser).childrenAges || "",

// Line 1543 - isVeteran property:
isVeteran: Boolean((user as ExtendedUser).isVeteran),

// Line 2952 - childrenAges in form validation:
{(user as ExtendedUser).childrenAges && (
  <span className="text-sm text-gray-500 dark:text-gray-400">
    (Ages: {(user as ExtendedUser).childrenAges})
  </span>
)}

// 8. Update the main ProfileContent function signature:
function ProfileContent({ userId: propUserId }: EnhancedProfileProps) {
  // ... existing code ...
  
  // Cast user to ExtendedUser at the beginning of the function:
  const extendedUser = user as ExtendedUser;
  
  // Then use extendedUser instead of user for properties that might not exist on base User type
}

// 9. Fix business ownership property access throughout:
// Replace all instances like:
// user.isMinorityOwned with (user as ExtendedUser).isMinorityOwned
// user.showMinorityOwned with (user as ExtendedUser).showMinorityOwned
// etc.

// 10. Complete list of property replacements needed:

// Business ownership properties:
(user as ExtendedUser).isVeteran
(user as ExtendedUser).isActiveDuty  
(user as ExtendedUser).isMinorityOwned
(user as ExtendedUser).isFemaleOwned
(user as ExtendedUser).isLGBTQIAOwned
(user as ExtendedUser).showMinorityOwned
(user as ExtendedUser).showFemaleOwned
(user as ExtendedUser).showLGBTQIAOwned

// Contact/business info:
(user as ExtendedUser).ownerName
(user as ExtendedUser).contactName
(user as ExtendedUser).ownerEmail
(user as ExtendedUser).ownerPhone
(user as ExtendedUser).services
(user as ExtendedUser).specialOffers
(user as ExtendedUser).targetCustomers
(user as ExtendedUser).certifications

// Family info:
(user as ExtendedUser).childrenAges

// Custom fields:
(user as ExtendedUser).customInterests
(user as ExtendedUser).customActivities
(user as ExtendedUser).customEvents